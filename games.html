<iframe data-testid="test_app_frame" id="test_app_frame" allowfullscreen="" allow="autoplay; fullscreen; camera; focus-without-user-activation *; monetization; gamepad;
             keyboard-map *; xr-spatial-tracking; clipboard-write" name="appFrame" scrolling="no" sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock
                allow-popups allow-popups-to-escape-sandbox allow-presentation allow-scripts allow-same-origin
                allow-downloads" src="https://db.duckmath.org/html/steal_a_brainrot_2/index.html" style="width: 100%; height: 100%; border: none;"></iframe>

<div class="games-grid" id="gameGrid">
    <div class="game-card" data-title="stealabrainrot" onclick="openGame('stealabrainrot.html')" style="transform: rotateY(0deg) rotateX(0deg) scale(1);">
        <img src=""><div class="game-title">Steal A Brainrot</div>
    </div>
                                          
        
    </div>
<script>

    
window.addEventListener("hashchange", () => {
    if (location.hash !== "#player") {
        const frame = document.getElementById("gameFrame");
        frame.src = ""; 
    }
});

window.addEventListener("load",()=>{
    setTimeout(()=>{
        const l=document.getElementById("loader");
        l.style.opacity="0";l.style.transition="0.6s";
        setTimeout(()=>l.remove(),600);
    },700);
});
function randomGame() {
    const games = [
        'stealabrainrot.html'
    ];

    const pick = games[Math.floor(Math.random() * games.length)];
    openGame(pick);
}

if(!location.hash)location.hash="#home";
function route(){
    const h=location.hash.replace("#","")||"home";
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    document.querySelectorAll("nav a").forEach(a=>a.classList.remove("active"));
    document.getElementById(h).classList.add("active");
    const nav=document.getElementById("nav-"+h);
    if(nav)nav.classList.add("active");
}
window.addEventListener("hashchange",route);
window.addEventListener("load",route);

function openGame(url){
function randomGame() {
    const cards = [...document.querySelectorAll(".game-card")].filter(c =>
        c.querySelector("img") && c.getAttribute("onclick")
    );

    if (cards.length === 0) return;

    const pick = cards[Math.floor(Math.random() * cards.length)];
    const onclickValue = pick.getAttribute("onclick");

    const file = onclickValue.match(/openGame\(['"](.+?)['"]\)/)[1];

    openGame(file);
}
    
    document.getElementById("gameFrame").src=url;
    
    if(url.includes("stealabrainrot")) title="Steal A Brainrot";

    document.getElementById("gameTitle").innerText=title;
    location.hash="game";
}

function backToGames(){location.hash="games";}
function fullscreen(){document.getElementById("gameFrame").requestFullscreen();}

function filterGames(){
    const q=document.getElementById("gameSearch").value.toLowerCase();
    const cards=[...document.querySelectorAll(".game-card")];
    cards.forEach(c=>{
        c.style.display=c.dataset.title.includes(q)?"flex":"none";
    });
    document.getElementById("gameGrid").style.justifyItems="center";
}

function setTheme(t){
    document.body.className=t;
    localStorage.setItem("theme",t);
}
window.addEventListener("load",()=>{
    const saved=localStorage.getItem("theme");
    if(saved)document.body.className=saved;
});

function openBlank(){
    let win=window.open("about:blank","_blank");
    win.document.write(document.documentElement.outerHTML);
    win.document.close();
}


const p=document.getElementById("particles");
const ctx=p.getContext("2d");
let w,h,pts=[];
function resize(){w=p.width=innerWidth;h=p.height=innerHeight;}
resize();addEventListener("resize",resize);
for(let i=0;i<180;i++){
    pts.push({x:Math.random()*w,y:Math.random()*h,s:Math.random()*2+1,v:.8+Math.random()});
}
function render(){
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle="white";
    pts.forEach(pt=>{
        ctx.beginPath();
        ctx.arc(pt.x,pt.y,pt.s,0,Math.PI*2);
        ctx.fill();
        pt.y+=pt.v;
        if(pt.y>h)pt.y=-10;
    });
    requestAnimationFrame(render);
}
render();
</script>